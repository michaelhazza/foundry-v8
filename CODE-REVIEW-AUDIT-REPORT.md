# Code Review Audit Report: Foundry

Generated by: Code Review Agent v25 (Sonnet Optimized)
Date: 2026-01-20
Repository: /home/user/foundry-v8

---

## Executive Summary

**Audit Status:** FAIL
**Deployment Ready:** NO

| Severity | Count |
|----------|-------|
| CRITICAL | 9 |
| HIGH | 10 |
| MEDIUM | 2 |
| LOW | 0 |
| **TOTAL** | **21** |

**Verdict:**
Code requires fixes before deployment. Multiple CRITICAL issues including malformed route paths, missing API endpoints, and Tailwind v3 syntax will cause deployment failures and runtime errors.

---

## Phase 1: Input Validation

- [x] 01-PRD.md found
- [x] 02-ARCHITECTURE.md found
- [x] 03-DATA-MODEL.md found
- [x] 04-API-CONTRACT.md found
- [x] 05-UI-SPECIFICATION.md found
- [x] 06-IMPLEMENTATION-PLAN.md found
- [x] 07-QA-DEPLOYMENT.md found

**Status:** PASS

---

## Phase 2: Critical Configuration Audit

### Check 2.1: Package.json Scripts
**Status:** PASS

### Check 2.2: Vite Configuration
**Status:** FAIL (missing watch.ignored)

### Check 2.3: Drizzle Configuration
**Status:** PASS

### Check 2.4: Replit Configuration
**Status:** PASS

### Check 2.5: TypeScript Configuration
**Status:** PASS

### Check 2.6: Environment Variables
**Status:** PASS

### Check 2.7: Server Entry Point
**Status:** PASS

### Check 2.8: API Prefix Consistency
**Status:** PASS

**Phase 2 Overall:** FAIL (1 issue)

---

## Phase 3: Specification Coverage Audit

### Check 3.1: Endpoint Coverage
**API Contract Count:** 33
**Implemented Count:** 31 (2 missing, 3 method mismatches)
**Status:** FAIL

### Check 3.2: Database Schema Coverage
**Status:** PASS (10/10 tables)

### Check 3.3: UI Screen Coverage
**Status:** FAIL (9/19 pages)

### Check 3.4: Form Validation Coverage
**Status:** PARTIAL

**Phase 3 Overall:** FAIL

---

## Phase 4: Replit Platform Compatibility

### Check 4.1: Database Driver
**Status:** PASS

### Check 4.2: Tailwind v4 Syntax
**Status:** FAIL

### Check 4.3: PostgreSQL Array Binding
**Status:** PASS

### Check 4.4: Static File Serving
**Status:** PASS

**Phase 4 Overall:** FAIL

---

## Phase 5: Code Quality Patterns

**Patterns Passed:** 21/25
**Patterns Failed:** 4 (5.5, 5.17, 5.18, 5.22)

**Phase 5 Overall:** FAIL

---

## Detailed Findings with GPT Improvement Guidance

### CRITICAL Issues

---

#### CRIT-001: Tailwind v3 Syntax Instead of v4

**What's Wrong:**
The file `client/src/index.css` uses Tailwind CSS v3 directive syntax (`@tailwind base; @tailwind components; @tailwind utilities;`) but the spec expects Tailwind v4 syntax which uses `@import "tailwindcss";`.

**What's Missing:**
The CSS file needs to use the correct import syntax for the Tailwind version specified in the project requirements.

**The Fix:**
Replace the three `@tailwind` directives with a single `@import "tailwindcss";` statement.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## CSS Framework Version Alignment Rule

When specifying Tailwind CSS setup:
1. Explicitly state the Tailwind version in package.json (v3.x or v4.x)
2. Document the EXACT CSS import syntax required for that version:
   - Tailwind v3: `@tailwind base; @tailwind components; @tailwind utilities;`
   - Tailwind v4: `@import "tailwindcss";`
3. Include a verification step: "Confirm CSS syntax matches installed Tailwind version"

The code generation agent MUST cross-reference package.json version with CSS syntax.
```

---

#### CRIT-002: Missing Slash Before Route Parameter (organizations.routes.ts:186)

**What's Wrong:**
The route path `'/current/members:userId'` is missing a `/` before the `:userId` parameter. Express requires parameters to be preceded by a slash to be recognized as dynamic segments.

**What's Missing:**
The slash character `/` between `members` and `:userId`.

**The Fix:**
Change `'/current/members:userId'` to `'/current/members/:userId'`

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Express Route Path Syntax Rules (CRITICAL)

Every route parameter MUST be preceded by a forward slash:
- CORRECT: `/users/:userId`
- WRONG: `/users:userId`

Before generating any route file, the agent MUST mentally validate each path:
1. Does every `:paramName` have a `/` immediately before it?
2. Does the path start with `/`?

Include this self-check comment in the prompt:
"After writing routes, scan for pattern `:[a-zA-Z]` NOT preceded by `/` - this is always an error."
```

---

#### CRIT-003: Missing Slash Before Route Parameter (organizations.routes.ts:233)

**What's Wrong:**
Same issue as CRIT-002. The route path `'/current/members:userId/role'` is missing a `/` before `:userId`.

**What's Missing:**
The slash character `/` between `members` and `:userId`.

**The Fix:**
Change `'/current/members:userId/role'` to `'/current/members/:userId/role'`

**GPT Prompt Improvement:**
Same as CRIT-002. This repeat occurrence indicates the GPT needs a systematic validation rule, not just awareness.

---

#### CRIT-004: Missing Slash Before Route Parameter (sources.routes.ts:203)

**What's Wrong:**
The route path `'/projects:projectId/sources'` is missing a `/` before `:projectId`.

**What's Missing:**
The slash character `/` between `projects` and `:projectId`.

**The Fix:**
Change `'/projects:projectId/sources'` to `'/projects/:projectId/sources'`

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Route Path Validation Checklist

Before finalizing any routes file, run this mental checklist:
1. List all route paths in the file
2. For each path, identify all `:paramName` segments
3. Verify each has format `/:paramName` (slash + colon + name)
4. Flag any instance of `/word:param` as ERROR

Example validation:
- `/projects/:projectId/sources` ✓ (/:projectId has slash)
- `/projects:projectId/sources` ✗ (missing slash before :projectId)
```

---

#### CRIT-005: Missing Leading Slash and Wrong Method/Path (sources.routes.ts:343)

**What's Wrong:**
Multiple issues with this route:
1. Path `':sourceId/configuration'` is missing the leading `/`
2. Uses `PUT` method but API Contract specifies `POST`
3. Path says `/configuration` but API Contract says `/configure`

**What's Missing:**
- Leading slash on the path
- Correct HTTP method (POST)
- Correct path segment (/configure not /configuration)

**The Fix:**
Change `router.put(':sourceId/configuration', ...)` to `router.post('/:sourceId/configure', ...)`

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## API Contract Cross-Reference Rule (MANDATORY)

For EVERY route implementation:
1. Look up the endpoint in 04-API-CONTRACT.md
2. Verify THREE things match exactly:
   - HTTP method (GET/POST/PUT/PATCH/DELETE)
   - Path structure (including exact segment names)
   - Parameter names

Example cross-reference:
```
API Contract says: POST /api/sources/:sourceId/configure
Implementation must be: router.post('/:sourceId/configure', ...)

NOT: router.put(':sourceId/configuration', ...) ← 3 errors!
```

Include explicit instruction: "Do not paraphrase paths. Use exact strings from API Contract."
```

---

#### CRIT-006: Direct parseInt Instead of parseIntParam (organizations.routes.ts:192)

**What's Wrong:**
The code uses `parseInt(req.params.userId as string, 10)` with manual `isNaN()` checking instead of the project's standard `parseIntParam()` utility function.

**What's Missing:**
Consistent use of the established parameter parsing utility that provides standardized error handling.

**The Fix:**
Replace `parseInt(req.params.userId as string, 10)` and the isNaN check with `parseIntParam(req.params.userId, 'userId')`.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Utility Function Usage Rules

When the codebase has established utility functions, ALWAYS use them:

For URL parameter parsing:
- NEVER use: `parseInt(req.params.id)`
- ALWAYS use: `parseIntParam(req.params.id, 'id')`

The Implementation Plan should list all utility functions that MUST be used:
- parseIntParam() - for numeric URL params
- parsePaginationParams() - for page/limit query params
- sendSuccess(), sendCreated(), sendPaginated() - for responses

Include instruction: "Search for existing utilities before writing inline parsing/validation code."
```

---

#### CRIT-007: Direct parseInt Instead of parseIntParam (organizations.routes.ts:240)

**What's Wrong:**
Same issue as CRIT-006, occurring at a different location in the same file.

**What's Missing:**
Same as CRIT-006.

**The Fix:**
Same as CRIT-006.

**GPT Prompt Improvement:**
The repetition in the same file indicates the GPT didn't apply the pattern consistently. Add to prompt:
```
"When using a utility function in a file, search the file for similar patterns that should also use it."
```

---

#### CRIT-008: Missing API Endpoint - PATCH /api/auth/profile

**What's Wrong:**
Endpoint #7 from the API Contract (`PATCH /api/auth/profile`) is not implemented in auth.routes.ts. This endpoint allows users to update their profile (name, password).

**What's Missing:**
The entire route handler for profile updates, including:
- Route definition: `router.patch('/profile', ...)`
- Authentication middleware
- Validation schema
- Update logic for name and password changes

**The Fix:**
Implement the PATCH /profile endpoint in auth.routes.ts following the API Contract specification for request/response format.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Endpoint Coverage Verification (MANDATORY)

Before completing any routes file:
1. Count endpoints in API Contract for that resource
2. Count implemented routes in the file
3. List any discrepancy

Auth endpoints checklist (from API Contract):
- [ ] POST /register (#2)
- [ ] POST /login (#3)
- [ ] POST /refresh (#4)
- [ ] POST /logout (#5)
- [ ] GET /me (#6)
- [ ] PATCH /profile (#7) ← COMMONLY MISSED
- [ ] POST /forgot-password (#8)
- [ ] GET /reset-password/:token (#9) ← COMMONLY MISSED
- [ ] POST /reset-password (#10)

Include explicit instruction: "Do not consider auth routes complete until all 9 auth endpoints are implemented."
```

---

#### CRIT-009: Missing API Endpoint - GET /api/auth/reset-password/:token

**What's Wrong:**
Endpoint #9 from the API Contract (`GET /api/auth/reset-password/:token`) is not implemented. This endpoint validates a password reset token and returns whether it's valid (and the associated email) before the user submits a new password.

**What's Missing:**
The route handler that:
- Accepts the token as a URL parameter
- Looks up the token in the database
- Checks if it's expired
- Returns `{ valid: boolean, email?: string }`

**The Fix:**
Implement the GET /reset-password/:token endpoint in auth.routes.ts.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Password Reset Flow - Two Endpoints Required

Password reset requires TWO endpoints (commonly confused):

1. GET /reset-password/:token - VALIDATES token before showing form
   - Input: token in URL
   - Output: { valid: boolean, email: string }
   - Purpose: Frontend checks if token is valid before showing password form

2. POST /reset-password - PROCESSES the reset
   - Input: { token, newPassword }
   - Output: { message: "Password updated" }
   - Purpose: Actually changes the password

Both endpoints are required. Do not implement only POST.
```

---

### HIGH Issues

---

#### HIGH-001: OAuth Tokens Stored Unencrypted

**What's Wrong:**
In `integrations.routes.ts:204-205`, Teamwork OAuth tokens are stored directly in the database without encryption. The code has TODO comments indicating this was known but not implemented.

**What's Missing:**
- An encryption utility function (encrypt/decrypt using AES-256-GCM)
- Calls to encrypt tokens before database storage
- Calls to decrypt tokens when retrieved for API calls

**The Fix:**
Create `server/lib/encryption.ts` with encrypt/decrypt functions using the ENCRYPTION_KEY environment variable, then use these when storing/retrieving OAuth tokens.

**GPT Prompt Improvement:**
```
Add to Architecture GPT (Agent 2) and Implementation Plan GPT (Agent 6):

## Security-Critical Implementation Rule

For sensitive data storage (OAuth tokens, API keys), the Implementation Plan MUST include:
1. Explicit encryption requirement with algorithm (AES-256-GCM)
2. Encryption utility function specification
3. Environment variable for encryption key

Do NOT generate code with "// TODO: Encrypt" comments. Either:
- Implement encryption fully, OR
- Throw an error if encryption key is not configured

TODOs in security-critical code paths are not acceptable.
```

---

#### HIGH-002: Teamwork API Not Implemented

**What's Wrong:**
The Teamwork Desk integration endpoint at `integrations.routes.ts:272` returns mock/placeholder data instead of making actual API calls to Teamwork's API.

**What's Missing:**
- HTTP client calls to Teamwork Desk API
- Token refresh logic when access token expires
- Proper error handling for API failures
- Data transformation from Teamwork format to application format

**The Fix:**
Implement actual Teamwork API calls using the stored OAuth credentials, including token refresh handling.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Third-Party API Integration Rule

When specifying API integrations:
1. Document the actual API endpoints to call (not just OAuth flow)
2. Specify request/response formats
3. Include token refresh logic requirements
4. Mark integration as "stub" or "full implementation" in scope

If integration is stub/mock for MVP:
- Document this explicitly in PRD
- Return proper error: "Integration not yet implemented"
- Do NOT return fake success data that misleads testing

If integration is in scope:
- Provide complete implementation including error handling
```

---

#### HIGH-003: Email Not Sent for Password Reset

**What's Wrong:**
In `auth.routes.ts:445`, a password reset token is generated and saved, but no email is actually sent to the user. There's a TODO comment instead of implementation.

**What's Missing:**
- Email service integration (SendGrid, Resend, etc.)
- Email template for password reset
- Actual send call with the reset link

**The Fix:**
Implement email sending using the configured email service, with graceful degradation if email is not configured (log token in development, return generic success in production).

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Optional Service Implementation Pattern

For optional services (email, SMS, etc.):

1. Check if service is configured: `if (config.isEmailEnabled)`
2. If configured: Send the email/SMS
3. If NOT configured in development: Log the token/code for testing
4. If NOT configured in production:
   - Still return success (don't leak configuration info)
   - Log warning for ops team

Example pattern:
```typescript
if (config.isEmailEnabled) {
  await emailService.sendPasswordReset(email, token);
} else if (config.isDevelopment) {
  console.log(`[DEV] Reset token for ${email}: ${token}`);
}
// Always return success - don't reveal if email exists
```

Do NOT leave TODO comments. Implement the conditional pattern.
```

---

#### HIGH-004: Invite Token Not Handled in Registration

**What's Wrong:**
In `auth.routes.ts:150`, when a user registers with an invite token, the code has a TODO instead of actual logic to join them to the existing organization.

**What's Missing:**
- Token validation (lookup, expiry check)
- Organization assignment from invitation
- Role assignment from invitation
- Invitation consumption (mark as used)

**The Fix:**
Implement the invite token flow: validate token, get org/role from invitation, create user in that org with that role, mark invitation as consumed.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Invitation Flow Implementation Requirements

Registration with invite token requires:
1. Validate token exists and not expired
2. Get organization_id and role from invitation
3. Create user in THAT organization (not new org)
4. Assign role from invitation
5. Mark invitation as consumed/used
6. Delete or invalidate the invitation token

The two registration paths:
- WITHOUT invite: Create new organization + admin user
- WITH invite: Join existing organization as invited role

Both paths must be fully implemented. No TODOs.
```

---

#### HIGH-005: Invite Email Not Sent

**What's Wrong:**
In `organizations.routes.ts:169`, when an admin creates an invitation, the invitation record is saved but no email is sent to the invitee.

**What's Missing:**
- Email with invitation link
- Invitation token in the email
- Instructions for the invitee

**The Fix:**
Send invitation email using the email service, with link to `/accept-invite?token=xxx`.

**GPT Prompt Improvement:**
Same as HIGH-003. Apply the optional service pattern for email sending.

---

#### HIGH-006: HTTP Method Mismatch - Organizations Update

**What's Wrong:**
In `organizations.routes.ts:81`, the route uses `router.put()` but the API Contract specifies `PATCH` for endpoint #12.

**What's Missing:**
Correct HTTP method alignment with the API Contract.

**The Fix:**
Change `router.put('/current', ...)` to `router.patch('/current', ...)`

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## HTTP Method Selection Rule

PATCH vs PUT distinction:
- PATCH: Partial update (only provided fields change) ← PREFERRED
- PUT: Full replacement (all fields must be provided) ← RARELY USED

The API Contract is the source of truth for HTTP methods.
When implementing, copy the method exactly from the API Contract table.

Do not assume "update = PUT". Check the spec.
```

---

#### HIGH-007: HTTP Method Mismatch - Projects Update

**What's Wrong:**
In `projects.routes.ts:249`, the route uses `router.put()` but the API Contract specifies `PATCH` for endpoint #19.

**What's Missing:**
Correct HTTP method.

**The Fix:**
Change `router.put('/:projectId', ...)` to `router.patch('/:projectId', ...)`

**GPT Prompt Improvement:**
Same as HIGH-006.

---

#### HIGH-008: HTTP Method and Path Mismatch - Source Configure

**What's Wrong:**
In `sources.routes.ts:343`:
- Uses `PUT` but API Contract says `POST`
- Uses `/configuration` but API Contract says `/configure`

**What's Missing:**
Both correct method and correct path.

**The Fix:**
Change `router.put('/:sourceId/configuration', ...)` to `router.post('/:sourceId/configure', ...)`

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## Path Naming - Exact Match Required

Route paths must EXACTLY match the API Contract. Common mistakes:
- `/configuration` vs `/configure` ← These are DIFFERENT paths
- `/list` vs `/` ← These are DIFFERENT paths

Do not paraphrase or "improve" path names during implementation.
Copy paths character-for-character from the API Contract.
```

---

#### HIGH-009: Missing AcceptInvitePage Component

**What's Wrong:**
There is no `AcceptInvitePage.tsx` in the pages directory, but the invitation flow requires a page where invited users can accept and complete registration.

**What's Missing:**
- React page component for `/accept-invite` route
- Token validation on page load
- Registration form pre-filled with invitation data
- Route definition in App.tsx

**The Fix:**
Create `client/src/pages/auth/AcceptInvitePage.tsx` with invitation acceptance UI, and add the route to App.tsx.

**GPT Prompt Improvement:**
```
Add to UI Specification GPT (Agent 5):

## Auth Flow Page Completeness Check

Every auth-related API endpoint needs a corresponding UI page:

| Endpoint | Required Page |
|----------|--------------|
| POST /auth/login | LoginPage ✓ |
| POST /auth/register | RegisterPage ✓ |
| POST /auth/forgot-password | ForgotPasswordPage ✓ |
| POST /auth/reset-password | ResetPasswordPage ✓ |
| POST /invitations/:token/accept | AcceptInvitePage ← OFTEN MISSED |

Include AcceptInvitePage in UI spec with:
- Route: /accept-invite or /invitations/:token
- Token validation on mount
- Pre-filled org name from invitation
- Password setup form
```

---

#### HIGH-010: Missing Vite watch.ignored Configuration

**What's Wrong:**
The `vite.config.ts` file has `watch.usePolling: true` for Replit compatibility but is missing the `ignored` array to exclude node_modules, .git, and dist directories.

**What's Missing:**
The `ignored` property in the watch configuration.

**The Fix:**
Add `ignored: ['**/node_modules/**', '**/.git/**', '**/dist/**']` to the watch config.

**GPT Prompt Improvement:**
```
Add to QA & Deployment GPT (Agent 7):

## Replit Vite Configuration Checklist

Required vite.config.ts settings for Replit:
```typescript
server: {
  host: '0.0.0.0',        // ✓ Bind all interfaces
  port: 5000,             // ✓ Replit's port
  watch: {
    usePolling: true,     // ✓ Required for Replit filesystem
    interval: 1000,       // ✓ Reduce CPU usage
    ignored: ['**/node_modules/**', '**/.git/**', '**/dist/**'],  // ← REQUIRED
  },
}
```

All four watch settings are required. Missing `ignored` causes performance issues.
```

---

### MEDIUM Issues

---

#### MED-001: Inconsistent Pagination Metadata Key

**What's Wrong:**
The response helper uses `pagination` as the key for pagination metadata, but the Constitution/Architecture may specify `meta` as the standard key.

**What's Missing:**
Consistency with the documented response envelope format.

**The Fix:**
Either update the response helper to use `meta`, or document that `pagination` is the project's chosen key.

**GPT Prompt Improvement:**
```
Add to Architecture GPT (Agent 2):

## Response Envelope Specification

Explicitly define the response envelope structure:
```typescript
{
  success: true,
  data: { ... },
  meta: {           // or "pagination" - pick ONE and document it
    page: 1,
    pageSize: 20,
    total: 100,
    totalPages: 5
  }
}
```

The chosen key name must be used consistently across:
- API Contract examples
- Response helper implementation
- Frontend API client expectations
```

---

#### MED-002: Only 9 of 19 UI Pages Implemented

**What's Wrong:**
The UI Specification lists 19 pages, but only 9 are implemented:
- ✓ LoginPage, RegisterPage, ForgotPasswordPage, ResetPasswordPage
- ✓ DashboardPage, ProjectListPage, ProjectCreatePage, ProjectDetailPage
- ✓ NotFoundPage
- ✗ AcceptInvitePage, ProfileSettingsPage, TeamManagementPage
- ✗ SourceUploadPage, SourceMappingPage, ProcessingDashboardPage
- ✗ DatasetDownloadPage, and others

**What's Missing:**
10 page components and their corresponding routes.

**The Fix:**
Implement remaining pages per UI Specification, prioritizing core user flows.

**GPT Prompt Improvement:**
```
Add to Implementation Plan GPT (Agent 6):

## UI Page Implementation Tracking

Include explicit page checklist with implementation order:

Phase 1 - Auth (MUST HAVE):
- [ ] LoginPage
- [ ] RegisterPage
- [ ] ForgotPasswordPage
- [ ] ResetPasswordPage
- [ ] AcceptInvitePage

Phase 2 - Core Flow (MUST HAVE):
- [ ] DashboardPage
- [ ] ProjectListPage
- [ ] ProjectCreatePage
- [ ] ProjectDetailPage

Phase 3 - Features (MUST HAVE for MVP):
- [ ] SourceUploadPage (or integrated)
- [ ] SourceMappingPage
- [ ] ProcessingDashboardPage
- [ ] DatasetDownloadPage

Phase 4 - Settings (SHOULD HAVE):
- [ ] ProfileSettingsPage
- [ ] TeamManagementPage

Mark each as implemented. Do not consider UI "done" until all Phase 1-3 pages exist.
```

---

## Fix Implementation Summary

| Priority | Issues | Action Required |
|----------|--------|-----------------|
| P0 | CRIT-002,003,004,005 | Fix route path syntax (immediate runtime failures) |
| P1 | CRIT-006,007 | Use parseIntParam utility |
| P1 | CRIT-008,009 | Implement missing auth endpoints |
| P2 | HIGH-006,007,008 | Fix HTTP methods to match spec |
| P2 | HIGH-001 | Implement token encryption |
| P3 | HIGH-003,004,005 | Implement email functionality |
| P3 | HIGH-009 | Create AcceptInvitePage |
| P4 | HIGH-002,010, MED-* | Address remaining issues |

---

## GPT Improvement Summary

### Changes Needed by Agent

| Agent | Key Improvements Needed |
|-------|------------------------|
| **Agent 2 (Architecture)** | Add encryption requirements, response envelope spec |
| **Agent 4 (API Contract)** | Already good - issues are in implementation, not spec |
| **Agent 5 (UI Spec)** | Add AcceptInvitePage, page completeness checklist |
| **Agent 6 (Implementation Plan)** | Route syntax rules, endpoint coverage verification, utility usage rules, HTTP method verification |
| **Agent 7 (QA/Deployment)** | Complete Vite config checklist |

### Top 5 Prompt Additions (Highest Impact)

1. **Route Path Syntax Validation** - Prevent 4 CRITICAL issues
2. **API Contract Cross-Reference Rule** - Prevent method/path mismatches
3. **Endpoint Coverage Checklist** - Prevent missing endpoints
4. **Utility Function Usage Rules** - Ensure consistency
5. **Optional Service Implementation Pattern** - Prevent TODO comments

---

## ASSUMPTION REGISTER

### AR-001: Tailwind Version
- **Type:** ASSUMPTION
- **Assumption:** Spec expects Tailwind v4 syntax
- **Impact if Wrong:** If v3 is intentional, CRIT-001 is invalid
- **Resolution:** Verify intended Tailwind version
- **Status:** UNRESOLVED
- **Owner:** Human

### AR-002: Teamwork Integration Scope
- **Type:** RISK
- **Assumption:** Teamwork API should be fully implemented, not mock
- **Impact if Wrong:** If mock is intentional for MVP, HIGH-002 is overstated
- **Resolution:** Confirm Teamwork integration scope
- **Status:** UNRESOLVED
- **Owner:** Human

### AR-003: Email Service Scope
- **Type:** ASSUMPTION
- **Assumption:** Email should work when configured
- **Impact if Wrong:** If email is post-MVP, HIGH-003/004/005 are overstated
- **Resolution:** Confirm email requirements
- **Status:** UNRESOLVED
- **Owner:** Human

---

## Document Validation

- [x] All 7 specs validated
- [x] All Phase 2-5 checks completed
- [x] All 25 patterns checked
- [x] All 21 findings documented with:
  - [x] What's wrong
  - [x] What's missing / the fix
  - [x] GPT prompt improvement guidance
- [x] Executive summary accurate

**Audit Status:** COMPLETE

---

**Document Status: COMPLETE**

The audit identified 21 issues with root cause analysis and GPT prompt improvement recommendations for each. Primary patterns to address in GPT prompts: route path syntax validation, API Contract cross-referencing, and endpoint coverage verification.
